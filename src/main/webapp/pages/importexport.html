<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8" />
    <title>HausFix - Import/Export</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Bootstrap CSS -->
    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"
            rel="stylesheet"
    />
    <!-- Font Awesome -->
    <link
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
            rel="stylesheet"
    />
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../css/pages.css" />
</head>
<body>
<div id="particles-js"></div>

<!-- Sidebar -->
<div id="sidebar">
    <h2>HausFix</h2>
    <ul class="nav">
        <li class="nav-item">
            <a href="dashboard.html" class="nav-link">
                <i class="fas fa-home"></i> Startseite
            </a>
        </li>
        <li class="nav-item">
            <a href="customers.html" class="nav-link">
                <i class="fas fa-users"></i> Kunden
            </a>
        </li>
        <li class="nav-item">
            <a href="reading.html" class="nav-link">
                <i class="fas fa-book"></i> Reading
            </a>
        </li>
        <li class="nav-item">
            <a href="importexport.html" class="nav-link active">
                <i class="fas fa-file-import"></i> Import/Export
            </a>
        </li>
        <li class="nav-item">
            <a href="logout.html" class="nav-link">
                <i class="fas fa-sign-out-alt"></i> Logout
            </a>
        </li>
    </ul>
</div>

<!-- Content -->
<div id="content">
    <header>
        <h1>Import / Export</h1>
        <p>Daten im Format JSON, XML oder CSV verwalten.</p>
    </header>

    <section class="w-75">
        <h3>Export Kunden</h3>
        <button class="btn btn-primary mb-2" onclick="exportCustomers('json')">
            Export JSON
        </button>
        <button class="btn btn-primary mb-2" onclick="exportCustomers('xml')">
            Export XML
        </button>
        <button class="btn btn-primary mb-2" onclick="exportCustomers('csv')">
            Export CSV
        </button>

        <hr/>

        <h3>Import Kunden</h3>
        <input type="file" id="fileInput" />
        <select id="importFormat" class="form-select w-25 d-inline-block">
            <option value="csv">CSV</option>
            <option value="xml">XML</option>
            <option value="json">JSON</option>
        </select>
        <button class="btn btn-success ms-2" onclick="importCustomers()">Import</button>
    </section>
</div>

<footer class="bg-dark text-white py-3 mt-auto">
    <div class="container text-center">
        <p>&copy; 2025 HausFix. Alle Rechte vorbehalten.</p>
        <p><small>Gruppe G: Max | Christian | Alper</small></p>
    </div>
</footer>

<!-- Bootstrap -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
<!-- Particles -->
<script src="../particles/particles.js"></script>
<script src="../particles/particles-config.js"></script>
<script src="../js/pages.js"></script>


<script>
    document.addEventListener("DOMContentLoaded", function () {
      if (localStorage.getItem("isLoggedIn") !== "true") {
        window.location.href = "../index.html";
      }
    });

    const apiBaseUrl = "http://localhost:8080";

    // Export-Funktion
    function exportCustomers(format) {
      // Z.B. GET /export/customers?format=csv
      window.open(\`${apiBaseUrl}/export/customers?format=\${format}\`);
    }

    // Import-Funktion
    async function importCustomers() {
      const fileInput = document.getElementById("fileInput");
      if (!fileInput.files.length) {
        alert("Bitte eine Datei ausw√§hlen.");
        return;
      }
      const format = document.getElementById("importFormat").value;
      const file = fileInput.files[0];

      const formData = new FormData();
      formData.append("file", file);

      try {
        const response = await fetch(\`${apiBaseUrl}/import/customers?format=\${format}\`, {
          method: "POST",
          body: formData
        });
        if (!response.ok) {
          throw new Error("Import fehlgeschlagen, HTTP " + response.status);
        }
        alert("Import erfolgreich!");
      } catch (err) {
        alert("Fehler: " + err.message);
      }
    }
</script>
</body>
</html>
